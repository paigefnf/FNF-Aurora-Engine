TODO:
rewrite a bunch of shit